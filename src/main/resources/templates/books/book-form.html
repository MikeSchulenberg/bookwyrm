<!DOCTYPE html>

<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header">

</head>

<body>
	<div th:replace="fragments/sidebar :: sidebar"></div>
	
	<div class="container main">
		<h1>Save Book</h1>
		
		<hr>
		
		<div class="container">
			<form th:action="@{/books/add-author}" th:object="${book}" method="POST">
				<th:block th:if="${!book['new']}">			
					<input type="hidden" th:field="*{id}">
					<input type="hidden" th:field="*{title}">
					<input type="hidden" th:field="*{genre}">
					<input type="hidden" th:field="*{seriesName}">
					<input type="hidden" th:field="*{seriesNumber}">
					
					<span class="font-weight-bold">
						Author(s)
					</span>
					
					<div th:each="author : ${book.authors}">
						<a th:href="@{'/authors/' + ${author.id}}">
							<span th:text="${author.firstName}"></span>
							<span th:if="${author.middleName != null}" th:text="${author.middleName}"></span>
							<span th:text="${author.lastName}"></span>
						</a>
					</div>
					
					<button type="submit" class="btn btn-primary btn-sm mb-4 mt-2">Add Author</button>
					
<!-- 					<div> -->
<!-- 						<a class="btn btn-primary btn-sm mb-4 mt-2" th:href="@{/books/add-author}" -->
<!-- 						   role="button"> -->
<!-- 							Add Author -->
<!-- 						</a> -->
<!-- 					</div> -->
				</th:block>
			</form>
				
			<form th:with="action=${book['new']} ? '/books/add-author' : '/books/save'"
				  th:action="@{${action}}" th:object="${book}" method="POST">
				<!-- hidden form field to handle Updates -->
				<input type="hidden" th:field="*{id}">

				<label class="font-weight-bold" for="title">
					Title
				</label>
				<input type="text" th:field="*{title}"
					   class="form-control mb-4 col-4" id="title" required>
				
				<label class="font-weight-bold"for="genre">
					Genre
				</label>	   
				<input type="text" th:field="*{genre}"
					   class="form-control mb-4 col-4" id="genre" required>
				
				<label class="font-weight-bold"for="series">
					Series
				</label>   
				<input type="text" th:field="*{seriesName}"
					   class="form-control mb-4 col-4" id="series">
					   
				<label class="font-weight-bold" for="number">
					Number
				</label>	   
				<input type="number" th:field="*{seriesNumber}"
					   class="form-control mb-4 col-4" min="1" id="number">
					   
				<button type="submit" class="btn btn-info">Save</button>
			</form>
		</div>	
	</div>
</body>
</html>